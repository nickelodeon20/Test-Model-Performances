# Undergraduate Research on Machine Learning/Deep Learning Models Use in Analyzing EEG, EOG Data

## Spring 2025 - Overview

Starting at the lab in February 2025, the first tasks assignmed to me involved analyzing the EEG Data collected utilizing the [BrainDecode](https://braindecode.org/stable/index.html) online library. I began reading through many of the library's explanations of their specific Machine Learning/Deep Learning models used to analyze different kinds of electrophysilogical data, the original publications associated with the models exploring their open source code and design choices, specific preprocessing methods from BrainDecode, and data conversion functionalities between popularly used data types like MNE, MOABB, or custom created datasets. Not all models on BrainDecode are replicas of their names as not every publication released open source reference code, so some of them are inexact recreations done by BrainDecode based off the methodolgoy of the scientists. Throughout the semester, I attempted to recreate some of the specific models for use on custom experimental datasets as well as trying to recreate their reported performance on the [BCI IV Competition](https://bbci.de/competition/iv/index.html) 2a dataset as a benchmark to check if my recreation of the model is accurate, since I had no prior experience to ML/DL models and needed a way to verify my implementations.


### <ins>ShallowFBCSPNet</ins>
BrainDecode's library contains the open source [ShallowFBCSPNet code](https://github.com/braindecode/braindecode//blob/master/braindecode/models/shallow_fbcsp.py#L14-L214) and the original [publication](https://doi.org/10.1002/hbm.23730). 

##### _Custom Dataset_
I utilized much of BrainDecode's open source code to create a model that worked with a privately collected EEG dataset in .csv file format from a file location on a local desktop. I also utilized Graduate student Weida Zhao's code for preprocessing the .csv data while adding some debugging functionality and connecting the two that turned the .csv data files into a MNE RawAray to fit better into the BrainDecode pipeline. 

For testing the model, I created a custom Train/Valid/Test split using 75%/25% on the first Train/Test split then an 88%/12% Train/Valid split used in the EEGClassifier to fit the model. The average performance for 50 epochs, learning rate = 0.001 and with the AdamW variant of the Adam optimizer, ranged between 92-94% for the limited dataset. Results of the most recent running are [here](https://github.com/nickelodeon20/UG.Research-Yazhou.Tu-AU/blob/main/EEG-Data-Models/ShallowFBCSPNet/ShallowFBCSPNet_211data.ipynb) (scroll all the way to the bottom for most of the code, the preprocessing has a very lengthy output I was not able to cut out). Graphical representations using BrainDecode Visualization Class, [scikit-Learn](https://scikit-learn.org/stable/index.html), and [Matplotlib](https://matplotlib.org/) include a Confusion Matrix model's output of the created Test split and a graph showing the variations in different Training/Validation metrics like Precision, Recall, F1 Score, both Accuracies, and both Loss values. Performance was not irrelevant, but as it was the first model I worked on, there was a large learning curve in grasping all the new libraries, models, and dataflow that leaves the actual implementation to be likely unoptimized and missing details.

##### _BCI-IV 2a Dataset_
I followed [this tutorial](https://braindecode.org/stable/auto_examples/model_building/plot_bcic_iv_2a_moabb_cropped.html#sphx-glr-auto-examples-model-building-plot-bcic-iv-2a-moabb-cropped-py) on BrainDecode that described downloading, preprocessing and running one of their models (this one happened to also be ShallowFBCSPNet) on the BCI-IV 2a dataset of 4-class EEG Data for Motor Imagery task classification. 

Apart from some dependency errors when installing BrainDecode and then MOABB while trying to load the dataset (which does correctly load if you rerun the cell - I do not exactly know why rerunning fixes the problem), the code I have [here](https://github.com/nickelodeon20/UG.Research-Yazhou.Tu-AU/blob/main/EEG-Data-Models/ShallowFBCSPNet/ShallowFBCSPNet_BCI_IV2a_data.ipynb) is BrainDecode's original code with slight modifications until the Train/Valid/Test split, where I was experimenting with shuffling the data various ways which does not work yet. If the "random.shuffle(all_ids)" and "train_set/valid_set = shuffle_trials_within_dataset()" are removed or commented out, the code should still run correctly without that unfinished functionality. There is a custom version of a Train/Valid/Test split, first using the labels in the BCI-IV 2a dataest of "Train" and "Test", then separating the "Train" set into a 80%/20% Train/Valid split. The Train/Valid split are used to fit the model while the Test set is used to evaluate at the end. 
